
#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN
#include <dcmt/dcmt.h>
#include <doctest/doctest.h>

#include <algorithm>
#include <array>

using dcmt::dcmt521;
using std::array;
using std::generate;

const int n = 100;

const array<dcmt521::result_type, n> expected_32_521_0_4172_1234{
    0x527415d6U, 0x77876c15U, 0xf09e6deaU, 0xd582955cU, 0x3bee0f14U,
    0xbbf15d5eU, 0xdb6d7f03U, 0x19fef1a1U, 0xd95d4addU, 0x17335683U,
    0x9ff34b23U, 0xcac40fd4U, 0xe8393380U, 0xecdefa75U, 0xcde293ecU,
    0xf8c26d8cU, 0x5782a03bU, 0x7a9f5637U, 0xafd8de1fU, 0x6e536955U,
    0x5d093870U, 0xc974ce02U, 0xfafcf1f1U, 0x4290453fU, 0x917343a5U,

    0x4b8854deU, 0xbb9afa59U, 0x221def7cU, 0xb1bd1c69U, 0xc5a0eefbU,
    0xd7e8450fU, 0x25137d34U, 0x48bf3bf9U, 0x97affa5aU, 0xa8e058b0U,
    0xfdf92601U, 0xc40e5d81U, 0xe6fe5936U, 0xe85f30c3U, 0x55854119U,
    0x652b1c86U, 0xcd359b65U, 0x696965f4U, 0x0e3ac05bU, 0x29c9cf0eU,
    0xe1aa8361U, 0xe32e7878U, 0x74304d00U, 0x06c54d22U, 0x00f21e88U,

    0xdc7fe873U, 0xf46bd84bU, 0xef77f649U, 0x39f90de6U, 0x1a120005U,
    0xf505a12eU, 0x8366f0d3U, 0xe83b7089U, 0xb4e2725bU, 0x37606f1eU,
    0xa715182aU, 0x6f9b11b7U, 0x3f0480a0U, 0xa45c8d70U, 0xcac23c36U,
    0xc094e795U, 0x031d2316U, 0x76df78dcU, 0x4d093faeU, 0xbaff149cU,
    0xe0229959U, 0x51a9777cU, 0x5ee8ddd8U, 0x7339234bU, 0x77c945b3U,

    0x3c1541b7U, 0xd2d09768U, 0x3095cd41U, 0xea424743U, 0x53cc83d1U,
    0x27cc6546U, 0xef085e98U, 0x229f8e6aU, 0x7810f6b0U, 0x3a221c4cU,
    0x87ffdf72U, 0xfbdc539bU, 0x368e61fbU, 0xe1518647U, 0x71ac535cU,
    0x31289d90U, 0xc44f9487U, 0x8660be22U, 0xaf540143U, 0xace75b1dU,
    0x52157678U, 0xe59fffc5U, 0xe71a1798U, 0x0337fadcU, 0xe1b5650dU,
};

const array<dcmt521::result_type, n> expected_32_521_1_4172_4567{
    0x00af2259U, 0xc7d8a3a7U, 0x7ec9c866U, 0x0f3c64baU, 0xabbcbd72U,
    0xad5b6275U, 0xc060150eU, 0x0e57a0a4U, 0x2d44a12fU, 0x62913251U,
    0x0e1e542bU, 0x01bc579bU, 0x0e775298U, 0x9327e768U, 0xd7f9dd9aU,
    0xc8722eabU, 0xbc24b101U, 0xf2e987acU, 0x54c2e82fU, 0x4eb1dffaU,
    0xfc90975eU, 0x6c38b66bU, 0x2eadb281U, 0x2ac99fbfU, 0x8dbc3656U,

    0xcfe0707bU, 0x4b1262b5U, 0xded27d51U, 0xdb6de64fU, 0x209da1cdU,
    0x3e677eceU, 0x73f3537cU, 0xb3eedaf2U, 0x6f048773U, 0x3fae9aa7U,
    0x51bbd234U, 0x78e6f450U, 0x4111d622U, 0xf8ca1b4dU, 0xc0a5fbb8U,
    0x7ab193f0U, 0x6a0291b9U, 0xaca957e0U, 0xcb13720bU, 0x787ce40fU,
    0x6fa399c5U, 0x616cf6d6U, 0x0d15f1faU, 0xb819fed3U, 0x0f047875U,

    0x67a19877U, 0x56527673U, 0xfb38c7c4U, 0xfc77ba8fU, 0x4ce2c3eaU,
    0x2a9809a3U, 0xed5f8746U, 0x8b78fb66U, 0x7b87d381U, 0xa4e9a082U,
    0xfea77146U, 0xe0f55c61U, 0x10743238U, 0xeb7757a1U, 0xa20053afU,
    0x33294901U, 0x677e28e8U, 0x18915a46U, 0xbb89ebdfU, 0x756ecd7dU,
    0x2c39878aU, 0x529d1b40U, 0x4cdd60b2U, 0xca2fd1c9U, 0xa6a03ad3U,

    0x6e69f2c0U, 0x87c6c615U, 0xa9489541U, 0xa8b41d59U, 0x8c456d2bU,
    0x691e9c77U, 0xa9982f46U, 0xa8a291b1U, 0xc1c6b53bU, 0xe8e8390fU,
    0x8644fad7U, 0xcf475280U, 0xd4fcd949U, 0xb70f2acaU, 0xa18a9f42U,
    0x6dd3a7a9U, 0x1c6b542eU, 0x8bdac4ffU, 0xebb6e211U, 0xfe4497dcU,
    0x53c846beU, 0x1280b77fU, 0x0d0c5adaU, 0x30fe5622U, 0x5a5e6c5eU,
};

const array<dcmt521::result_type, n> expected_32_521_999_4172_8901{
    0x25810b80U, 0xc608933fU, 0xa7277662U, 0x2315fe87U, 0x80e94e47U,
    0x5406d957U, 0xc4181b50U, 0x9b45ac86U, 0xdd75553bU, 0x1cc69638U,
    0x2df38e5eU, 0x0c02307aU, 0x1da2b946U, 0x7f01e8d0U, 0x520c478eU,
    0x8d477443U, 0x8f7e447fU, 0x1fd4bb0aU, 0x2c3d2393U, 0x8737b749U,
    0x7b32454fU, 0xc9a48bebU, 0x5970a1e0U, 0xf06bf3fbU, 0xdadc2511U,

    0x850b50a1U, 0x5d35c5a4U, 0x2f4ef8f2U, 0x32a20abcU, 0xbb7d4253U,
    0x04575ad6U, 0xc374ece8U, 0x6f61b7e9U, 0x0e005919U, 0xb80a04afU,
    0x566c2530U, 0xfde0815fU, 0xc97a5c8bU, 0x6571350eU, 0x787ef66cU,
    0x6534b52cU, 0x78575612U, 0x7bc7ebdbU, 0xb29aa7dbU, 0x233a226fU,
    0x2e819c46U, 0xda442de5U, 0xf913314cU, 0x43c91e5eU, 0x694579bbU,

    0x0673478dU, 0x75c652c9U, 0x7ef89a17U, 0x943d2184U, 0x0db5a625U,
    0x4af9ad34U, 0x94ec2cc4U, 0x3553b6bbU, 0xaf34d8b2U, 0x8c8143cfU,
    0x924dc2bcU, 0xe2260354U, 0x6370e06aU, 0x7e2f8fc0U, 0x53d283afU,
    0xd30b0e4fU, 0xf12fd06bU, 0x3d0945e1U, 0x88d29a4fU, 0xf6423f3dU,
    0x89c0c18eU, 0xe176492eU, 0x0e506860U, 0x27f9f812U, 0x5522adbdU,

    0x79be4578U, 0x487d706cU, 0x579a3f33U, 0x33882f93U, 0x0c01ca1cU,
    0xb6bc45b6U, 0xe4096877U, 0xc13e0b34U, 0x287ba3faU, 0xa803176aU,
    0xb25714f0U, 0xdacade1fU, 0xd010af0bU, 0x1078d5f8U, 0xa6237ee0U,
    0x757fa997U, 0xf570726bU, 0x0234f897U, 0xb6b280ecU, 0x7743484dU,
    0x2b3975edU, 0x7186d1a5U, 0x85c2a9ebU, 0x554a25c7U, 0x4f3242f6U,
};

TEST_CASE("sequences in readme") {
  dcmt521 rng1{dcmt521::param_type{0}, 1234};
  dcmt521 rng2{dcmt521::param_type{1}, 4567};
  dcmt521 rng3{dcmt521::param_type{999}, 8901};

  array<dcmt521::result_type, n> a1;
  array<dcmt521::result_type, n> a2;
  array<dcmt521::result_type, n> a3;

  generate(begin(a1), end(a1), rng1);
  generate(begin(a2), end(a2), rng2);
  generate(begin(a3), end(a3), rng3);

  for (int i = 0; i < n; i++) {
    CHECK_MESSAGE(a1[i] == expected_32_521_0_4172_1234[i], "i == " << i);
    CHECK_MESSAGE(a2[i] == expected_32_521_1_4172_4567[i], "i == " << i);
    CHECK_MESSAGE(a3[i] == expected_32_521_999_4172_8901[i], "i == " << i);
  }
}
